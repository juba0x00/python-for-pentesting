#!/usr/bin/env python3.10

# Directory-Enum.py <url> <List>

from argparse import ArgumentParser
from requests import get


def get_directories(wordlist):
    wordlist_file = open(str(wordlist), 'r')
    directories = [line.replace('\n', '') for line in wordlist_file.readlines()]
    wordlist_file.close()
    return directories


def parse_args():
    parser = ArgumentParser(description="Directory-Enum.py URL LIST")
    parser.add_argument('url', help='URL')
    parser.add_argument('wordlist', help='Specify a wordlist')
    return parser.parse_args()


def main():
    args = parse_args()
    directories = get_directories(args.wordlist)
    fuzz(args.url, directories)
    del args, directories
    

def fuzz(url, directories):

    # ! remove / from the URL
    url = str(url).replace('/', '') if str(url).endswith('/') else url
    for directory in directories:
        if get(f'{url}/{directory}').status_code != 404:
            print(f'{url}/{directory}')


if __name__ == "__main__":
    main()
